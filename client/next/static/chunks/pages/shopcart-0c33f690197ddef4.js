(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[877],{68154:function(o,r,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/shopcart",function(){return t(42535)}])},42535:function(o,r,t){"use strict";t.r(r),t.d(r,{__N_SSG:function(){return j},default:function(){return g}});var e=t(85893),n=t(67294),c=t(37568),s=t(16569),a=t(17972),i=t.n(a),d=t(80927),l=t(98),u=t(6154);async function h(o){let r=null;return await u.Z.delete("http://localhost:3001/"+o,{headers:{"Access-Control-Allow-Credentials":!0},withCredentials:!0,crossDomain:!0}).then(o=>{r=o}).catch(function(o){r=o}),r}let p=o=>{let{props:r}=o,t=(0,d.T)();return console.log(r),(0,e.jsx)(e.Fragment,{children:(0,e.jsxs)("div",{className:i().ShopCart,children:[(0,e.jsxs)("div",{className:i().MainInfoBlock,children:[(0,e.jsx)("div",{className:i().ShopCart_image,children:(0,e.jsx)("img",{src:"/img/products/".concat(r.IdProducts.ImgProducts,".webp")})}),(0,e.jsxs)("div",{className:i().ShopCart_InfoBlock,children:[(0,e.jsx)("h2",{children:r.IdProducts.NameProduct}),(0,e.jsxs)("p",{children:["Всего товаров: ",r.IdProducts.CountProducts]}),(0,e.jsxs)("p",{children:["Цена: ",r.IdProducts.PriceProducts]})]})]}),(0,e.jsxs)("div",{className:i().DopInfoBlock,children:[(0,e.jsxs)("div",{className:i().ShopCart_PriceBlock,children:[(0,e.jsxs)("p",{children:["Колличество: ",r.CountProduct]}),(0,e.jsxs)("div",{className:i().CountSelector,children:[(0,e.jsx)("button",{onClick:()=>{t(l.Z.actions.plusCount({id:r.id,countProducts:r.CountProduct-1,maxCount:r.IdProducts.CountProducts}))},children:"-"}),(0,e.jsx)("button",{onClick:()=>{t(l.Z.actions.plusCount({id:r.id,countProducts:r.CountProduct+1,maxCount:r.IdProducts.CountProducts}))},children:"+"})]})]}),(0,e.jsx)("div",{className:i().ShopCart_SummBlock,children:(0,e.jsxs)("h2",{children:["Cумма: ",r.IdProducts.PriceProducts*r.CountProduct]})}),(0,e.jsx)("button",{onClick:()=>(function(o){h("order-shopingcart/".concat(o,"_").concat(r.IdShopingCart.id)).then(o=>t(l.Z.actions.cheked(o.data)))})(r.id),className:i().onDelete})]})]})})};var C=t(19660);let _=o=>{let{props:r,fullPrice:t}=o,c=(0,d.C)(o=>o.ShopPointSlice),s=(0,d.C)(o=>o.ShopCartSlice),[a,l]=(0,n.useState)("1");async function u(){let o=await (0,C.j)("order-product",{IdShopingCart:r.shopingCart,IdPointOrders:Number(a),StatusOrder:!1,shopingCart:s.shopCart,FullPrice:t});console.log(o.data.confirmation.confirmation_url),window.location=o.data.confirmation.confirmation_url}return console.log(t),console.log(a),console.log(r),(0,e.jsxs)("div",{className:i().wrupperEnterOrders,children:[(0,e.jsx)("select",{value:a,onChange:o=>{l(o.target.value)},children:c.shopPoint.map(o=>(0,e.jsxs)("option",{value:o.id,children:[o.country," ",o.city," ",o.street," ",o.numberHouse]},o.id))}),(0,e.jsxs)("div",{className:i().priceBlock,children:[(0,e.jsxs)("h2",{children:["Итого: ",t," руб"]}),(0,e.jsx)("button",{onClick:()=>u(),className:i().enterOrders,children:"Заказать"})]})]})};var S=n.memo(_),m=t(46618),x=t(1159);let P=()=>{let o=(0,d.T)(),r=(0,d.C)(o=>o.ShopCartSlice),{User:t,AuthBoll:c}=(0,d.C)(o=>o.UserReducers),s=0;return r.shopCart.map(o=>{s+=o.IdProducts.PriceProducts*o.CountProduct}),(0,n.useEffect)(()=>{c&&((0,m.A)("order-shopingcart","".concat(t.shopingCart)).then(r=>o(l.Z.actions.cheked(r))),(0,m.A)("point-orders").then(r=>o(x.A.actions.cheked(r))))},[c,r.isLoading]),(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)("div",{className:i().ShopCartModule,children:r.isLoading?(0,e.jsx)("div",{children:"Загрузка..."}):r.shopCart.map(o=>(0,e.jsx)(p,{props:o},o.id))}),(0,e.jsxs)("div",{className:i().headerPointer,children:[(0,e.jsx)("h2",{children:"Оформление заказа:"}),(0,e.jsx)("p",{children:"Пункт выдачи:"})]}),r.shopCart.length>0?(0,e.jsx)(S,{props:t,fullPrice:s}):(0,e.jsx)("h1",{children:"В корзине нет товаров"})]})};var j=!0;function g(o){return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(c.Z,{categorys:o.categorys,undercategorys:o.underCategorys}),(0,e.jsx)(s.Z,{categorys:o.categorys,undercategorys:o.underCategorys}),(0,e.jsx)(P,{})]})}},17972:function(o){o.exports={ShopCart:"ShopCart_ShopCart__Eo2uo",MainInfoBlock:"ShopCart_MainInfoBlock__ww92m",ShopCart_image:"ShopCart_ShopCart_image__yZH8U",ShopCart_InfoBlock:"ShopCart_ShopCart_InfoBlock__t5ONw",DopInfoBlock:"ShopCart_DopInfoBlock__X_hSe",ShopCart_PriceBlock:"ShopCart_ShopCart_PriceBlock__iXqrW",CountSelector:"ShopCart_CountSelector__fpJYD",ShopCart_SummBlock:"ShopCart_ShopCart_SummBlock__B1VoG",wrupperEnterOrders:"ShopCart_wrupperEnterOrders__m8r09",priceBlock:"ShopCart_priceBlock__p_5Hv",enterOrders:"ShopCart_enterOrders__zbtI9",ShopCartModule:"ShopCart_ShopCartModule__StZZB",onDelete:"ShopCart_onDelete__evRAc",headerPointer:"ShopCart_headerPointer__u7c0c"}}},function(o){o.O(0,[100,182,774,888,179],function(){return o(o.s=68154)}),_N_E=o.O()}]);